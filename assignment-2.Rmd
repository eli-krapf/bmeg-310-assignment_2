---
title: "Assignment 2"
author: "Maggie Wang"
date: "2023-10-10"
output:
  pdf_document: default
  html_document: default
---

### Setup

---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r, load libraries}
# Load required libraries
library(ggplot2)
library(ggbiplot)
library(ROCR)
```

```{r, load data}
# Set the seed
set.seed(1)

# Read data
ovarian.data <- na.omit(read.delim("ovarian.data", sep=",", header = FALSE))
features <- c("perimeter", "area", "smoothness", "symmetry", "concavity", paste("protein", seq(1, 25), sep=""))
names(ovarian.data) <- c("cell_id", "diagnosis", features) # paste0(features,"_mean"), paste0(features,"_se"), paste0(features,"_worst"))

dim(ovarian.data)
head(ovarian.data)
```

### Q1. Dimensionality Reduction

---

**Q1.1**
```{r, Q1.1}
ovarian.pca <- prcomp(ovarian.data[,c(3:32)], center = TRUE,scale. = TRUE)
summary(ovarian.pca)
str(ovarian.pca)
```
About 42.77% of the variation in the data is associated with PC1.

**Q1.2**
To represent 90% of the variance in the data by dimensionality reduction, you would need about 9 PCs.

**Q1.3**
```{r, Q1.3}
q1.3_plot <- ggplot(ovarian.data, aes(x = area, y = perimeter)) +
  geom_point(aes(color = diagnosis)) +
  labs(title = "Area vs. Perimeter of Tumor", 
       x = "Area",
       y = "Perimeter", 
       color = "Diagnosis")
q1.3_plot
```

**Q1.4**
```{r, Q1.4}
q1.4_plot <- ggplot(ovarian.data, aes(x = area, y = concavity)) +
  geom_point(aes(color = diagnosis)) +
  labs(title = "Area vs. Concavity of Tumor", 
       x = "Area",
       y = "Concavity", 
       color = "Diagnosis")
q1.4_plot
```

**Q1.5**
The first plot using the first two important PCs has more separation between the 
classes, while in the second one they are a lot more mixed. This is because the
first two PCs have the highest proportion of the variation in the dataset, so 
they will have the most difference between them.

**Q1.6**
```{r, Q1.6 (bonus)}

```

### Q2. Clustering

---

**Q2.1**
```{r, Q2.1}

```

**Q2.2**
```{r, Q2.2}

```

**Q2.3**
```{r, Q2.3}

```

**Q2.4**
```{r, Q2.4}

```

### Q3. Classification

---

```{r}
# Divide dataset into training and testing sets
ovarian.data.train <- ovarian.data[sample(nrow(ovarian.data))[1:(nrow(ovarian.data)/2)],]
ovarian.data.test <- ovarian.data[sample(nrow(ovarian.data))[(nrow(ovarian.data)/2):(nrow(ovarian.data))],]
```

**Q3.1**
```{r, Q3.1}

```

**Q3.2**
```{r, Q3.2}

```

**Q3.3**
```{r, Q3.3}

```

**Q3.4**
```{r, Q3.4}

```

**Q3.5**
```{r, Q3.5, ROC curve}
pred.prob <- predict(your.model, ovarian.data, type="response")
predict <- prediction(pred.prob, ovarian.data$diagnosis, label.ordering=c("B","M"))
perform <- performance(predict,"tpr","fpr")
plot(perform,colorize=TRUE)
```

**Q3.6**
```{r, Q3.6}

```